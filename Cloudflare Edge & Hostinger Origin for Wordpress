
- Direct access to origin IP: âŒ **BLOCKED**
- Access via Cloudflare (global): âœ… **ALLOWED**
- No geo-restrictions

---

## â˜ï¸ Cloudflare Configuration (FINAL)

### DNS
- Records: **Proxied (orange cloud)**
- No grey-cloud records for the site

### SSL / TLS
- Mode: **Full (strict)**
- Always Use HTTPS: **ON**
- Minimum TLS: Default (TLS 1.2+)
- TLS 1.3: **ON**

### HSTS
- Enabled: **ON**
- `includeSubDomains`: **ON**
- `preload`: **OFF**
- `max-age`: `15552000` (6 months)

### Security (Free Plan)
- Cloudflare Managed Ruleset: **ON**
- Bot Fight Mode: **ON**
- Turnstile: **ON** (WordPress login/forms)
- No country-based rules
- No paid WAF rules required

### Response Header Hardening (Transform Rules)
Remove:
- `X-Powered-By`
- `Report-To`
- `NEL`
- `Speculation-Rules`
- `Server-Timing` *(Cloudflare may still add `cfL4`; acceptable)*

Keep:
- `server: cloudflare`
- `cf-ray`

---

## ðŸ–¥ï¸ Hostinger / Origin Configuration (FINAL)

### PHP Settings
- `exposePhp`: **OFF**
- `displayErrors`: **OFF**
- `session.cookieSecure`: **ON**
- `session.cookieHttpOnly`: **ON**
- `session.useStrictMode`: **ON** (recommended, safe for WordPress)

### Web Server
- LiteSpeed (default)
- Do **NOT** use Hostinger IP Manager for Cloudflare allowlisting  
  (manual blocks only, if needed)

---

## ðŸ§± `.htaccess` â€” FINAL (Authoritative)

> Place this block **at the very top** of `.htaccess`,  
> **above LiteSpeed Cache and WordPress rules**.

```apache
# ============================================
# Cloudflare-only access (LiteSpeed/Hostinger SAFE) - FINAL
# ============================================

<IfModule mod_authz_core.c>
  <RequireAny>
    # --- Cloudflare IPv4 ---
    Require ip 173.245.48.0/20
    Require ip 103.21.244.0/22
    Require ip 103.22.200.0/22
    Require ip 103.31.4.0/22
    Require ip 141.101.64.0/18
    Require ip 108.162.192.0/18
    Require ip 190.93.240.0/20
    Require ip 188.114.96.0/20
    Require ip 197.234.240.0/22
    Require ip 198.41.128.0/17
    Require ip 162.158.0.0/15
    Require ip 104.16.0.0/13
    Require ip 104.24.0.0/14
    Require ip 172.64.0.0/13
    Require ip 131.0.72.0/22

    # --- Cloudflare IPv6 (future-proof) ---
    Require ip 2400:cb00::/32
    Require ip 2606:4700::/32
    Require ip 2803:f800::/32
    Require ip 2405:b500::/32
    Require ip 2405:8100::/32
    Require ip 2a06:98c0::/29
    Require ip 2c0f:f248::/32

    # --- Local health ---
    Require ip 127.0.0.1
  </RequireAny>
</IfModule>

<IfModule !mod_authz_core.c>
  Order Deny,Allow
  Deny from all

  Allow from 173.245.48.0/20
  Allow from 103.21.244.0/22
  Allow from 103.22.200.0/22
  Allow from 103.31.4.0/22
  Allow from 141.101.64.0/18
  Allow from 108.162.192.0/18
  Allow from 190.93.240.0/20
  Allow from 188.114.96.0/20
  Allow from 197.234.240.0/22
  Allow from 198.41.128.0/17
  Allow from 162.158.0.0/15
  Allow from 104.16.0.0/13
  Allow from 104.24.0.0/14
  Allow from 172.64.0.0/13
  Allow from 131.0.72.0/22
  Allow from 127.0.0.1
</IfModule>

# ============================================
# End Cloudflare allowlist
# ============================================

# Remove PHP fingerprinting (defense in depth)
<IfModule mod_headers.c>
  Header always unset X-Powered-By
</IfModule>

# Block XML-RPC (common WordPress attack surface)
<Files "xmlrpc.php">
  <IfModule mod_authz_core.c>
    Require all denied
  </IfModule>
  <IfModule !mod_authz_core.c>
    Order Allow,Deny
    Deny from all
  </IfModule>
</Files>
